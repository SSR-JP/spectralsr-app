(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7524],{6449:function(e,t,n){Promise.resolve().then(n.bind(n,1393))},1393:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var r=n(9241),a=n(2960),o=n(1326),i=n(4990),l=n(8549),s=n(7351),c=n(4893),u=n(6557),d=n(8409),p=n(49),f=n(7205),m=n(7894),h=n(2265),v=n(7818),g=n(5041),Z=n(6463),y=n(3098),b=n(2331),x=n(3457),w=n(9278),C=n(4326),k=n(149),B=n(4299),F=n(4980),M=n(3796);let I=(0,v.default)(()=>Promise.all([n.e(5934),n.e(9109),n.e(2008)]).then(n.bind(n,2008)),{loadableGenerated:{webpack:()=>[2008]},ssr:!1});function O(){let e=(0,a.Z)(),[t,n]=(0,h.useState)("gaussian"),[v,O]=(0,F.Ay)();(0,h.useRef)(O).current=O;let{setActiveStep:S}=(0,b.b)(),[L]=(0,B.mN)(),N=L.apiClient,_=(0,Z.useRouter)(),[R,T]=(0,h.useState)("zoom"),[P,E]=(0,h.useState)([]),[H,V]=(0,h.useState)(0),[j,z]=(0,h.useState)(0),[X,D]=(0,h.useState)(0),[G,K]=(0,h.useState)(0),[q,W]=(0,h.useState)(""),[A,J]=(0,h.useState)(!1),Y=e=>{W(e),T("select")},Q=()=>{W(""),T("zoom")};(0,h.useEffect)(()=>{if(S(1),"loaded"!==v.status){_.push("/");return}let e=v.originalDataset.filter(e=>e.using);if(0===e.length){console.error("No original data."),(0,g.yv)("No original data.",{variant:"error"});return}let{samplesX:t}=e[0],r=t.map((t,n)=>e.map(e=>e.samplesY[n]).sort((e,t)=>e-t));E((0,w.T)(t,r)),V(t[Math.floor(t.length/6)]),z(t[Math.floor(t.length/6*3)]),D(t[Math.floor(t.length/8*5)]),K(t[Math.floor(t.length/8*7)]),(async()=>{try{let e=await N.serviceFetch("dataset/fitting/settings/latest",[]);if(!e.ok){let t=await e.text();throw Error("HTTP error! status: ".concat(e.status,", ").concat(t))}let t=await e.json();if(!t)throw Error("No data");let{fitting_function:r,peak_range:a,noise_range:o}=t;n(r),V(a[0]),z(a[1]),D(o[0]),K(o[1]);return}catch(e){}})()},[]);let U=async()=>{if(v.isLocked){_.push("/calc/ssr-parameter-settings");return}J(!0);try{let e=await N.serviceFetch("dataset/fitting/start",[],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fitting_function:t,peak_range:[H,j],noise_range:[X,G]})});if(!e.ok){let t=await (0,B.NZ)(e);(0,g.yv)(t,{variant:"error",action:M.D,persist:!0}),J(!1);return}_.push("/calc/ssr-parameter-settings"),J(!1)}catch(e){console.error(e),(0,g.yv)("".concat(e),{variant:"error",action:M.D,persist:!0}),J(!1)}};return(0,r.BX)(x.T,{onNext:U,onBack:()=>_.push("/calc/data-cleansing"),children:[(0,r.BX)(o.Z,{sx:{display:"grid",height:{sm:"auto",md:"100%"},gridTemplateColumns:{sm:"1fr",md:"2fr 1fr"},gridTemplateRows:{sm:"1fr 1fr",md:"1fr"},gap:1},children:[(0,r.tZ)("div",{css:(0,y.iv)({display:"flex",justifyContent:"center"}),children:(0,r.tZ)(I,{data:P,layout:{width:640,height:400,dragmode:R,shapes:[{type:"rect",xref:"x",yref:"paper",x0:H,y0:0,x1:j,y1:1,fillcolor:e.palette.primary.main,opacity:.2,line:{width:0}},{type:"rect",xref:"x",yref:"paper",x0:X,y0:0,x1:G,y1:1,fillcolor:e.palette.secondary.main,opacity:.2,line:{width:0}}]},onSelected:e=>{let t=[e.range.x[0],e.range.x[1]];"peak"===q?(V(t[0]),z(t[1])):"noise"===q&&(D(t[0]),K(t[1]))}})}),(0,r.BX)(i.Z,{sx:{padding:1},children:[(0,r.BX)(l.Z,{fullWidth:!0,disabled:v.isLocked,children:[(0,r.tZ)(s.Z,{children:"フィッティング関数"}),(0,r.BX)(c.Z,{value:t,onChange:e=>{n(e.target.value)},children:[(0,r.tZ)(u.Z,{value:"gaussian",children:"Gaussian"}),(0,r.tZ)(u.Z,{value:"lorentz",children:"Lorentz"})]})]}),(0,r.BX)(d.Z,{component:"legend",sx:{mt:3,display:"flex",alignItems:"center"},children:[(0,r.tZ)("span",{children:"フィッティング領域"}),(0,r.tZ)(m.Z,{color:"primary"})]}),(0,r.BX)(p.Z,{children:[(0,r.tZ)(f.Z,{disableHoverListener:!0,title:"グラフ上で範囲選択できます。",children:(0,r.tZ)(C.Ki,{label:"左側",disabled:v.isLocked,sx:{mt:1},value:H,onChange:e=>V(e),onFocus:()=>Y("peak"),onBlur:()=>Q()})}),(0,r.tZ)(f.Z,{disableHoverListener:!0,title:"グラフ上で範囲選択できます。",children:(0,r.tZ)(C.Ki,{label:"右側",disabled:v.isLocked,sx:{mt:1},value:j,onChange:e=>z(e),onFocus:()=>Y("peak"),onBlur:()=>Q()})})]}),(0,r.BX)(d.Z,{component:"legend",sx:{mt:3,display:"flex",alignItems:"center"},children:[(0,r.tZ)("span",{children:"ノイズ領域"}),(0,r.tZ)(m.Z,{color:"secondary"})]}),(0,r.BX)(p.Z,{children:[(0,r.tZ)(f.Z,{disableHoverListener:!0,title:"グラフ上で範囲選択できます。",children:(0,r.tZ)(C.Ki,{label:"左側",disabled:v.isLocked,sx:{mt:1},value:X,onChange:e=>D(e),onFocus:()=>Y("noise"),onBlur:()=>Q()})}),(0,r.tZ)(f.Z,{disableHoverListener:!0,title:"グラフ上で範囲選択できます。",children:(0,r.tZ)(C.Ki,{label:"右側",disabled:v.isLocked,sx:{mt:1},value:G,onChange:e=>K(e),onFocus:()=>Y("noise"),onBlur:()=>Q()})})]})]})]}),(0,r.tZ)(k.f,{open:A})]})}},7894:function(e,t,n){"use strict";var r=n(3963);t.Z=void 0;var a=r(n(9118)),o=n(7437);t.Z=(0,a.default)((0,o.jsx)("path",{d:"M3 5v4h2V5h4V3H5c-1.1 0-2 .9-2 2m2 10H3v4c0 1.1.9 2 2 2h4v-2H5zm14 4h-4v2h4c1.1 0 2-.9 2-2v-4h-2zm0-16h-4v2h4v4h2V5c0-1.1-.9-2-2-2"}),"CropFree")},9118:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=n(9013)},467:function(e,t,n){"use strict";n.d(t,{L:function(){return o}});var r=n(2296),a=n(587);function o(e){return(0,a.ZP)("MuiListItemText",e)}let i=(0,r.Z)("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);t.Z=i},6557:function(e,t,n){"use strict";n.d(t,{Z:function(){return M}});var r=n(3950),a=n(2988),o=n(2265),i=n(4839),l=n(6990),s=n(317),c=n(8024),u=n(1738),d=n(5885),p=n(1175),f=n(9022),m=n(8632),h=n(909),v=n(8525),g=n(2296);let Z=(0,g.Z)("MuiListItemIcon",["root","alignItemsFlexStart"]);var y=n(467),b=n(587);function x(e){return(0,b.ZP)("MuiMenuItem",e)}let w=(0,g.Z)("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]);var C=n(7437);let k=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],B=e=>{let{disabled:t,dense:n,divider:r,disableGutters:o,selected:i,classes:s}=e,c=(0,l.Z)({root:["root",n&&"dense",t&&"disabled",!o&&"gutters",r&&"divider",i&&"selected"]},x,s);return(0,a.Z)({},s,c)},F=(0,c.ZP)(f.Z,{shouldForwardProp:e=>(0,u.Z)(e)||"classes"===e,name:"MuiMenuItem",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.divider&&t.divider,!n.disableGutters&&t.gutters]}})(e=>{let{theme:t,ownerState:n}=e;return(0,a.Z)({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!n.disableGutters&&{paddingLeft:16,paddingRight:16},n.divider&&{borderBottom:"1px solid ".concat((t.vars||t).palette.divider),backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(w.selected)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):(0,s.Fq)(t.palette.primary.main,t.palette.action.selectedOpacity),["&.".concat(w.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):(0,s.Fq)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},["&.".concat(w.selected,":hover")]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.hoverOpacity,"))"):(0,s.Fq)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):(0,s.Fq)(t.palette.primary.main,t.palette.action.selectedOpacity)}},["&.".concat(w.focusVisible)]:{backgroundColor:(t.vars||t).palette.action.focus},["&.".concat(w.disabled)]:{opacity:(t.vars||t).palette.action.disabledOpacity},["& + .".concat(v.Z.root)]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},["& + .".concat(v.Z.inset)]:{marginLeft:52},["& .".concat(y.Z.root)]:{marginTop:0,marginBottom:0},["& .".concat(y.Z.inset)]:{paddingLeft:36},["& .".concat(Z.root)]:{minWidth:36}},!n.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},n.dense&&(0,a.Z)({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{["& .".concat(Z.root," svg")]:{fontSize:"1.25rem"}}))});var M=o.forwardRef(function(e,t){let n;let l=(0,d.i)({props:e,name:"MuiMenuItem"}),{autoFocus:s=!1,component:c="li",dense:u=!1,divider:f=!1,disableGutters:v=!1,focusVisibleClassName:g,role:Z="menuitem",tabIndex:y,className:b}=l,x=(0,r.Z)(l,k),w=o.useContext(p.Z),M=o.useMemo(()=>({dense:u||w.dense||!1,disableGutters:v}),[w.dense,u,v]),I=o.useRef(null);(0,m.Z)(()=>{s&&I.current&&I.current.focus()},[s]);let O=(0,a.Z)({},l,{dense:M.dense,divider:f,disableGutters:v}),S=B(l),L=(0,h.Z)(I,t);return l.disabled||(n=void 0!==y?y:-1),(0,C.jsx)(p.Z.Provider,{value:M,children:(0,C.jsx)(F,(0,a.Z)({ref:L,role:Z,tabIndex:n,component:c,focusVisibleClassName:(0,i.Z)(S.focusVisible,g),className:(0,i.Z)(S.root,b)},x,{ownerState:O,classes:S}))})})},9013:function(e,t,n){"use strict";n.r(t),n.d(t,{capitalize:function(){return a.Z},createChainedFunction:function(){return o},createSvgIcon:function(){return i.Z},debounce:function(){return l.Z},deprecatedPropType:function(){return s},isMuiElement:function(){return c.Z},ownerDocument:function(){return u.Z},ownerWindow:function(){return d.Z},requirePropFactory:function(){return p},setRef:function(){return f},unstable_ClassNameGenerator:function(){return x},unstable_useEnhancedEffect:function(){return m.Z},unstable_useId:function(){return h.Z},unsupportedProp:function(){return v},useControlled:function(){return g.Z},useEventCallback:function(){return Z.Z},useForkRef:function(){return y.Z},useIsFocusVisible:function(){return b.Z}});var r=n(9424),a=n(2272),o=n(1897).Z,i=n(9528),l=n(576),s=function(e,t){return()=>null},c=n(4204),u=n(9645),d=n(8095);n(2988);var p=function(e,t){return()=>null},f=n(9969).Z,m=n(8632),h=n(8256),v=function(e,t,n,r,a){return null},g=n(5115),Z=n(6182),y=n(909),b=n(6658);let x={configure:e=>{r.Z.configure(e)}}},4326:function(e,t,n){"use strict";n.d(t,{Ki:function(){return i},rB:function(){return o}});var r=n(9241),a=n(6858);function o(e){return t=>parseFloat(Number(t).toPrecision(e))}let i=(0,n(2265).forwardRef)(function(e,t){let{label:n,value:o,onChange:i,onBlur:l=()=>{},validator:s,disabled:c,...u}=e,d=null!=s?s:e=>parseFloat(Number(e).toFixed(3));return(0,r.tZ)(a.Z,{disabled:c,ref:t,label:n,value:"number"==typeof o?d(o):o,onChange:e=>{i(e.target.value)},onBlur:e=>{i(d(e.target.value)),null==l||l()},onKeyDown:e=>{let t=e.target;"Enter"===e.key&&i(d(t.value))},...u})})},9278:function(e,t,n){"use strict";n.d(t,{T:function(){return o}});var r=n(2592);function a(e,t){let n=t/100*(e.length-1),r=Math.floor(n),a=r+1,o=n%1;return a>=e.length?e[r]:e[r]*(1-o)+e[a]*o}function o(e,t){let n={x:[...e,...e.toReversed()],y:[...t.map(e=>a(e,0)),...t.map(e=>a(e,100)).reverse()],fill:"toself",fillcolor:r.Z[50],line:{width:0},type:"scatter",showlegend:!1},o={x:[...e,...e.toReversed()],y:[...t.map(e=>a(e,10)),...t.map(e=>a(e,90)).reverse()],fill:"toself",fillcolor:r.Z[100],line:{width:0},type:"scatter",showlegend:!1},i={x:[...e,...e.toReversed()],y:[...t.map(e=>a(e,20)),...t.map(e=>a(e,80)).reverse()],fill:"toself",fillcolor:r.Z[200],line:{width:0},type:"scatter",showlegend:!1};return[n,o,i,{x:[...e,...e.toReversed()],y:[...t.map(e=>a(e,30)),...t.map(e=>a(e,70)).reverse()],fill:"toself",fillcolor:r.Z[300],line:{width:0},type:"scatter",showlegend:!1},{x:[...e,...e.toReversed()],y:[...t.map(e=>a(e,40)),...t.map(e=>a(e,60)).reverse()],fill:"toself",fillcolor:r.Z[400],line:{width:0},type:"scatter",showlegend:!1},{x:e,y:null==t?void 0:t.map(e=>a(e,50)),mode:"lines",marker:{color:r.Z[500]},showlegend:!1}]}}},function(e){e.O(0,[1665,9241,526,2036,1650,3676,5981,4692,5380,1892,9294,659,5971,8015,8576,2971,7023,1744],function(){return e(e.s=6449)}),_N_E=e.O()}]);